<div class="mainContainer" *ngIf="isWholePageLoaded; else loading">
    <div class="sidePanel">
        <div class="profile">
            <div class="profileImg">
                <!-- Show cropped image if available, otherwise fallback to default -->
                <img [src]="croppedImage" class="profile-pic" [alt]="vendorName[0]" />

                <!-- File input trigger -->
                <input type="file" accept="image/*" (change)="fileChangeEvent($event)" hidden #fileInput />
                <button type="button" class="addBtn" (click)="fileInput.click()">
                    <i class="fa-solid fa-pen"></i>
                </button>
            </div>


            <!-- Show cropper only after an image is selected -->
            <div *ngIf="imageChangedEvent" class="cropperModal">
                <div class="cropperContent">
                    <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="true"
                        [aspectRatio]="1" format="png" (imageCropped)="imageCropped($event)">
                    </image-cropper>

                    <div class="buttonGroup">
                        <button (click)="cancelCrop()"><i class="fa-solid fa-xmark"></i></button>
                        <button (click)="confirmCrop()"><i class="fa-solid fa-check"></i></button>
                    </div>
                </div>
            </div>



            <h3 class="name">{{vendorName}}</h3>
            <p class="title">{{contactNo}}</p>
        </div>
        <div class="divider"></div>


        <div class="otherOptions">
            <ul class="menu">
                <li [ngClass]="{ 'active': activeOption === 'Dashboard' }" (click)="setActive('Dashboard')">
                    <i class="fa-solid fa-chart-column"
                        style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Dashboard
                </li>
                <li [ngClass]="{ 'active': activeOption === 'AddBus' }" (click)="setActive('AddBus')">
                    <i class="fa-solid fa-bus-simple" style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Bus
                </li>
                <li [ngClass]="{ 'active': activeOption === 'AddSchedule' }" (click)="setActive('AddSchedule')">
                    <i class="fa-solid fa-clock" style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Schedule
                </li>
                <li [ngClass]="{ 'active': activeOption === 'Bookings' }" (click)="setActive('Bookings')">
                    <i class="fas fa-table" style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Bookings
                </li>
                <li [ngClass]="{ 'active': activeOption === 'Earnings' }" (click)="setActive('Earnings')">
                    <i class="fa-solid fa-hand-holding-dollar" style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Earnings
                </li>
                <li [ngClass]="{ 'active': activeOption === 'Profile' }" (click)="setActive('Profile')">
                    <i class="fa-solid fa-user" style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Profile
                </li>
                <li [ngClass]="{ 'active': activeOption === 'Settings' }" (click)="setActive('Settings')">
                    <i class="fas fa-cog" style="font-size: 18px; margin-right: 0.375rem; width: 22px;"></i>
                    Settings
                </li>
            </ul>
        </div>
    </div>
    <div class="content" *ngIf="!selectingImage">
        <ng-container *ngComponentOutlet="currentComponent; injector: injector">
        </ng-container>
    </div>
</div>


<ng-template #loading>
    <div class="loading-container">
        <div class="bus-spinner">
            <i class="fas fa-bus"></i>
        </div>
        <p>Loading RedBus Vendor, please wait...</p>
    </div>
</ng-template>